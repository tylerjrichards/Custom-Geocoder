---
title: "Creating and Using a Custom Geocoder in R"
author: "Document Author"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
---

#Overview

There are already many very useful and good geocoders. From [Google's API](https://developers.google.com/maps/documentation/geocoding/start) to [MapQuest's](https://developer.mapquest.com/documentation/geocoding-api/) to even [OpenStreetMap's version](http://geocoder.readthedocs.io/providers/OpenStreetMap.html). However, if these do not get the job done, or are giving you incorrect results, you may want to create your own.  
  
This tutorial will walk through how to make a geocoder by creating a database, making it accessible and editable from google spreadsheets for usability, and then accessing the database accessible through the use of a REST API. 

##The Database and Google Sheets

Thanks to [Jenny Bryan](https://twitter.com/JennyBryan), interacting with sheets is made easier through the [googlesheets package](https://cran.r-project.org/web/packages/googlesheets/vignettes/basic-usage.html). 

```{r eval =F}
#Can access by name or by link, the googlesheets package will sign you in and make a gitignore file for your project
library(googlesheets)
suppressMessages(library(dplyr))

```

```{r eval = F}
#by link
Spreadsheet_url <- "https://docs.google.com/spreadsheets/your_google_link"
Spreadsheet <-Spreadsheet_url %>% 
  gs_url()
Spreadsheet_data <- Spreadsheet %>% 
  gs_read(ws = "Sheet_name")

```

```{r eval = F}
#by name
Spreadsheet <- gs_title("Spreadsheet_name")
Spreadsheet_data <- Spreadsheet %>% 
  gs_read(ws = "Sheet_name")
```

I have found the gs_title() function to be easier to use. Additionally, if you do not want to use a google sheet for data entry and already have a .csv or .txt file you want to use, the read.csv() function will handle that data perfectly fine.  

Once you have the spreadsheet data, we need to create a database that has a table with the spreadsheet's data. We'll use dbplyr for this. 

In my use case, I needed to make a database for the United States and then a table for each state I was considering. For each state I was working with, I would replace Spreadsheet_data with the state I was working with the state I needed. 

```{r eval = F}
library(dbplyr)
US_dat <- src_sqlite("US_Geocoding.db", create = TRUE)

copy_to(US_dat, Spreadsheet_data, temporary = FALSE)

```



